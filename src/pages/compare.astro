---
// src/pages/compare.astro
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';
import PlayerComparison from '../components/PlayerComparison'; // Ensure this path is correct

// 1. Fetch Data
// We need ALL players for the dropdowns
// We need ALL teams to look up colors and logos
const allPlayers = await getCollection('players');
const allTeams = await getCollection('teams');

// Optional: Sort players alphabetically to make the dropdown easier to use
const sortedPlayers = allPlayers.sort((a, b) => 
  a.data.name.localeCompare(b.data.name)
);
---

<BaseLayout title="Compare Players - Nexus" fullWidth={true}>
  
  <div class="min-h-screen bg-neutral-950 pt-32 pb-24 px-4 md:px-8">
    
    {/* Page Header */}
    <div class="max-w-7xl mx-auto text-center mb-16">
       <div class="inline-block mb-4">
          <span class="px-3 py-1 rounded border border-amber-500/30 bg-amber-500/10 text-amber-500 text-xs font-bold uppercase tracking-widest">
            Database Analysis
          </span>
       </div>
       <h1 class="font-title text-6xl md:text-8xl text-white italic font-black tracking-tighter mb-6 leading-none">
         HEAD TO HEAD
       </h1>
       <p class="text-neutral-400 text-lg max-w-2xl mx-auto">
         Select two players to compare career length, acomplishments and signature heroes.
       </p>
    </div>

    {/* The Interactive React Component */}
    {/* client:load is crucial because it needs JavaScript for the dropdowns */}
    <PlayerComparison 
      client:load 
      players={sortedPlayers} 
      teams={allTeams} 
    />

  </div>

</BaseLayout>
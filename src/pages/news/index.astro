---
import BaseLayout from '../../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

// 1. Get all news entries
const allNews = (await getCollection('news')).sort(
  (a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf()
);
---

<BaseLayout title="News Archive" fullWidth={true}>
  
  <div class="min-h-screen bg-[#0a0a0a] relative">
     
     {/* Simple Header */}
     <div class="relative py-20 text-center border-b border-neutral-900 bg-neutral-950">
        <h1 class="text-5xl md:text-7xl font-title text-white mb-4">Analyst Desk</h1>
        <p class="text-neutral-400 max-w-2xl mx-auto text-lg">
           Latest news, meta reports, and analysis from the OWCS.
        </p>
     </div>

     {/* Article Grid */}
     <div class="max-w-7xl mx-auto px-6 py-16">
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
           
           {allNews.map((article) => (
             <a 
               href={`/news/${article.slug}`} 
               class="group flex flex-col bg-neutral-900 border border-neutral-800 rounded-2xl overflow-hidden hover:border-zinc-500 transition-all hover:-translate-y-1 shadow-lg"
             >
                {/* Image */}
                <div class="relative h-48 overflow-hidden">
                   <img 
                     src={article.data.image} 
                     alt={article.data.title} 
                     class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105"
                   />
                   <div class="absolute top-4 left-4 bg-black/80 backdrop-blur-md px-3 py-1 rounded text-[10px] font-bold uppercase tracking-wider text-white border border-white/10">
                      {article.data.tag}
                   </div>
                </div>

                {/* Text */}
                <div class="p-6 flex flex-col flex-1">
                   <div class="flex items-center gap-2 text-xs font-bold text-zinc-500 mb-3">
                      <span>{article.data.publishDate.toLocaleDateString()}</span>
                      <span>•</span>
                      <span>{article.data.author}</span>
                   </div>
                   <h3 class="text-xl font-title text-white mb-3 leading-tight group-hover:text-amber-500 transition-colors">
                      {article.data.title}
                   </h3>
                   <p class="text-zinc-400 text-sm line-clamp-3 mb-6 flex-1">
                      {article.data.excerpt}
                   </p>
                   <div class="text-xs font-bold text-white uppercase tracking-widest flex items-center gap-2">
                      Read Story <span>→</span>
                   </div>
                </div>
             </a>
           ))}

        </div>
     </div>

  </div>
</BaseLayout>
---
import BaseLayout from '../layouts/BaseLayout.astro';
import FlatWorldMap from '../components/WorldMap.tsx';

// --- 1. CONFIG: NATIONAL TEAMS (Mock Data) ---
// We hardcode lat/lng here to ensure perfect map placement
const nationalTeams = [
  // AMER
  { data: { name: "United States", region: "North America", color: "#3b82f6", logo: "https://flagcdn.com/w320/us.png" }, lat: 37.09024, lng: -95.712891, slug: "usa" },
  { data: { name: "Canada", region: "North America", color: "#ef4444", logo: "https://flagcdn.com/w320/ca.png" }, lat: 56.130366, lng: -106.346771, slug: "canada" },
  { data: { name: "Brazil", region: "North America", color: "#22c55e", logo: "https://flagcdn.com/w320/br.png" }, lat: -14.235004, lng: -51.92528, slug: "brazil" },
  { data: { name: "Mexico", region: "North America", color: "#22c55e", logo: "https://flagcdn.com/w320/mx.png" }, lat: 23.634501, lng: -102.552784, slug: "mexico" },
  { data: { name: "Colombia", region: "North America", color: "#22c55e", logo: "https://flagcdn.com/w320/co.png" }, lat: 4.570868 , lng: -74.297333, slug: "colombia" },
  
  // EMEA
  { data: { name: "France", region: "EMEA", color: "#3b82f6", logo: "https://flagcdn.com/w320/fr.png" }, lat: 46.2, lng: 2.2, slug: "france" },
  { data: { name: "Spain", region: "EMEA", color: "#eab308", logo: "https://flagcdn.com/w320/es.png" }, lat: 40.463667, lng: -3.74922, slug: "spain" },
  { data: { name: "United Kingdom", region: "EMEA", color: "#ef4444", logo: "https://flagcdn.com/w320/gb.png" }, lat: 55.3, lng: -3.4, slug: "uk" },
  { data: { name: "Saudi Arabia", region: "EMEA", color: "#22c55e", logo: "https://flagcdn.com/w320/sa.png" }, lat: 23.8, lng: 45.0, slug: "saudi-arabia" },
  { data: { name: "Finland", region: "EMEA", color: "#3b82f6", logo: "https://flagcdn.com/w320/fi.png" }, lat: 61.9, lng: 25.7, slug: "finland" },
  { data: { name: "Denmark", region: "EMEA", color: "#ef4444", logo: "https://flagcdn.com/w320/dk.png" }, lat: 56.26392, lng: 9.501785, slug: "denmark" },
  { data: { name: "Sweden", region: "EMEA", color: "#22c55e", logo: "https://flagcdn.com/w320/se.png" }, lat: 60.128161, lng: 18.643501, slug: "sweden" },
  { data: { name: "Norway", region: "EMEA", color: "#3b82f6", logo: "https://flagcdn.com/w320/no.png" }, lat: 60.472024, lng: 8.468946, slug: "norway" },

  // APAC
  { data: { name: "South Korea", region: "Korea", color: "#ec4899", logo: "https://flagcdn.com/w320/kr.png" }, lat: 35.9, lng: 127.7, slug: "south-korea" },
  { data: { name: "China", region: "China", color: "#ef4444", logo: "https://flagcdn.com/w320/cn.png" }, lat: 35.8, lng: 104.1, slug: "china" },
  { data: { name: "Japan", region: "Japan", color: "#ef4444", logo: "https://flagcdn.com/w320/jp.png" }, lat: 36.2, lng: 138.2, slug: "japan" },
  { data: { name: "Australia", region: "Pacific", color: "#eab308", logo: "https://flagcdn.com/w320/au.png" }, lat: -25.2, lng: 133.7, slug: "australia" },
  { data: { name: "Hong Kong", region: "Japan", color: "#ef4444", logo: "https://flagcdn.com/w320/hk.png" }, lat: 22.396428, lng: 114.109497, slug: "hong-kong" },
  { data: { name: "Thailand", region: "Pacific", color: "#eab308", logo: "https://flagcdn.com/w320/th.png" }, lat: 15.870032, lng: 100.992541, slug: "thailand" },
];

const timeline = [
  { date: "NOV 2025", label: "Committee Apps", position: "top", status: "completed" },
  { date: "SPRING 2026", label: "Team Selection", position: "top", status: "active" },
  { date: "MARCH 2026", label: "Conference Cups", position: "bottom", status: "upcoming", isMajor: true }, // Special "Major" node
  { date: "SUMMER 2026", label: "Online Qualifiers", position: "top", status: "upcoming" },
  { date: "LATE SUMMER", label: "Live Group Stage", position: "bottom", status: "upcoming" },
  { date: "SEPT 2026", label: "BlizzCon Finals", position: "top", status: "upcoming" },
];

const BRAND_ORANGE = "#F05A14";
const BRAND_GREY = "#333E48";
---

<BaseLayout title="War Room" fullWidth={true} theme="worldcup">
  
  <div class="min-h-screen bg-[#0f1114] relative overflow-hidden">
     <div class="absolute inset-0 opacity-5 pointer-events-none" style={`background-image: radial-gradient(${BRAND_ORANGE} 1px, transparent 1px); background-size: 40px 40px;`}></div>

     <div class="max-w-7xl mx-auto px-4 py-12 relative z-10">
        
        {/* HEADER */}
        <div class="text-center mb-24">
           <h1 class="text-6xl md:text-8xl font-title text-white mb-4 drop-shadow-[0_0_35px_rgba(240,90,20,0.4)]">WAR ROOM</h1>
           <div class="inline-flex items-center gap-3 border-y border-[#F05A14]/30 py-2 px-6">
              <span class="text-[#F05A14] font-bold uppercase tracking-[0.3em]">Overwatch World Cup 2026</span>
           </div>
        </div>

        {/* --- 1. THE OFFICIAL TIMELINE --- */}
        <div class="mb-32 relative">
           
           {/* The Central Line */}
           <div class="absolute top-1/2 left-0 w-full h-0.5 bg-[#333E48] -translate-y-1/2 rounded-full"></div>

           {/* The Nodes Grid */}
           <div class="grid grid-cols-2 md:grid-cols-6 gap-4 relative z-10">
              {timeline.map((step, i) => {
                 const isTop = step.position === 'top';
                 const isActive = step.status === 'active';
                 const isCompleted = step.status === 'completed';
                 
                 return (
                   <div class={`flex flex-col items-center relative h-32 justify-${isTop ? 'start' : 'end'} -my-16`}>
                      
                      {/* TOP CONTENT */}
                      {isTop && (
                        <div class="text-center mb-4 pb-4 border-l border-[#333E48] pl-4 relative">
                           <div class="absolute bottom-0 left-0 w-2 h-2 bg-[#333E48] rounded-full -ml-[5px]"></div>
                           <span class="block text-white font-title text-xl mb-1">{step.date}</span>
                           <span class="block text-[#F05A14] text-xs font-bold uppercase tracking-wider">{step.label}</span>
                        </div>
                      )}

                      {/* THE NODE (Circle on the line) */}
                      <div class={`
                        w-6 h-6 rounded-full border-4 relative z-20 transition-all duration-500
                        ${isActive ? 'bg-[#0f1114] border-[#F05A14] scale-125 shadow-[0_0_20px_#F05A14]' : 
                          isCompleted ? 'bg-[#F05A14] border-[#F05A14]' : 'bg-[#0f1114] border-[#333E48]'}
                      `}>
                         {isActive && <div class="absolute inset-0 rounded-full bg-[#F05A14] opacity-20 animate-ping"></div>}
                      </div>

                      {/* BOTTOM CONTENT */}
                      {!isTop && (
                        <div class="text-center mt-4 pt-4 border-l border-[#333E48] pl-4 relative">
                           <div class="absolute top-0 left-0 w-2 h-2 bg-[#333E48] rounded-full -ml-[5px]"></div>
                           
                           {step.isMajor ? (
                             /* Colorful Text for Conference Cups */
                             <div class="flex flex-col items-start">
                               <span class="text-red-500 font-black text-[10px] tracking-widest uppercase">ASIA</span>
                               <span class="text-green-500 font-black text-[10px] tracking-widest uppercase">EMEA</span>
                               <span class="text-purple-500 font-black text-[10px] tracking-widest uppercase">AMER</span>
                               <span class="block text-white font-title text-xl mt-1">{step.label}</span>
                               <span class="text-[#F05A14] text-xs font-bold uppercase">{step.date}</span>
                             </div>
                           ) : (
                             <>
                               <span class="block text-white font-title text-xl mb-1">{step.label}</span>
                               <span class="block text-[#F05A14] text-xs font-bold uppercase tracking-wider">{step.date}</span>
                             </>
                           )}
                        </div>
                      )}

                   </div>
                 )
              })}
           </div>
        </div>
        

        {/* --- 2. THE MAP --- */}
        <div class="border border-[#F05A14]/30 rounded-3xl overflow-hidden bg-[#1a1d21] shadow-2xl mb-24 relative group">
           <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-transparent via-[#F05A14] to-transparent opacity-50"></div>
           
           {/* Map Component */}
           <FlatWorldMap teams={nationalTeams} client:only="react" />
           
           {/* HUD Overlay */}
           <div class="absolute bottom-6 left-6 px-4 py-2 bg-[#F05A14] text-white font-black font-title text-sm uppercase tracking-wide shadow-lg transform skew-x-[-10deg]">
              <span class="skew-x-[10deg] inline-block">Global Tracking // Live</span>
           </div>
        </div>


        {/* --- 3. THE CONFERENCES --- */}
        <div class="grid grid-cols-1 md:grid-cols-3 gap-12 border-t border-[#333E48] pt-12">
           
           {/* AMERICAS */}
           <div>
              <h3 class="text-2xl font-title text-white border-b-4 border-[#333E48] pb-2 mb-6 flex items-center justify-between">
                 AMER
                 <span class="text-[#F05A14] text-xs font-mono bg-[#F05A14]/10 px-2 py-1 rounded border border-[#F05A14]/30">Conference A</span>
              </h3>
              <div class="space-y-2">
                 {nationalTeams.filter(t => t.data.region === 'North America').map(t => (
                    <div class="flex items-center gap-4 p-3 rounded bg-[#1a1d21] border border-[#333E48] hover:border-[#F05A14] transition-colors cursor-pointer group">
                       <img src={t.data.logo} class="w-8 h-5 object-contain shadow-sm" alt={t.data.name} />
                       <span class="font-bold text-gray-400 group-hover:text-white">{t.data.name}</span>
                    </div>
                 ))}
              </div>
           </div>

           {/* EMEA */}
           <div>
              <h3 class="text-2xl font-title text-white border-b-4 border-[#333E48] pb-2 mb-6 flex items-center justify-between">
                 EMEA
                 <span class="text-[#F05A14] text-xs font-mono bg-[#F05A14]/10 px-2 py-1 rounded border border-[#F05A14]/30">Conference B</span>
              </h3>
              <div class="space-y-2">
                 {nationalTeams.filter(t => ['EMEA', 'Saudi Arabia'].includes(t.data.region)).map(t => (
                    <div class="flex items-center gap-4 p-3 rounded bg-[#1a1d21] border border-[#333E48] hover:border-[#F05A14] transition-colors cursor-pointer group">
                       <img src={t.data.logo} class="w-8 h-5 object-contain shadow-sm" alt={t.data.name} />
                       <span class="font-bold text-gray-400 group-hover:text-white">{t.data.name}</span>
                    </div>
                 ))}
              </div>
           </div>

           {/* ASIA */}
           <div>
              <h3 class="text-2xl font-title text-white border-b-4 border-[#333E48] pb-2 mb-6 flex items-center justify-between">
                 APAC
                 <span class="text-[#F05A14] text-xs font-mono bg-[#F05A14]/10 px-2 py-1 rounded border border-[#F05A14]/30">Conference C</span>
              </h3>
              <div class="space-y-2">
                 {nationalTeams.filter(t => ['Korea', 'China', 'Japan', 'Pacific'].includes(t.data.region)).map(t => (
                    <div class="flex items-center gap-4 p-3 rounded bg-[#1a1d21] border border-[#333E48] hover:border-[#F05A14] transition-colors cursor-pointer group">
                       <img src={t.data.logo} class="w-8 h-5 object-contain shadow-sm" alt={t.data.name} />
                       <span class="font-bold text-gray-400 group-hover:text-white">{t.data.name}</span>
                    </div>
                 ))}
              </div>
           </div>

        </div>

     </div>
  </div>
</BaseLayout>
---
interface Props {
  title: string;
  subtitle: string;
  description: string;
  // Added 'market' to the allowed list
  theme: 'amber' | 'blue' | 'emerald' | 'cyan' | 'purple' | 'red' | 'market'; 
  align?: 'left' | 'right'; 
  primaryLink?: { text: string; href: string };
  secondaryLink?: { text: string; href: string };
}

// 1. DESTRUCTURE PROPS
const { 
  title, 
  subtitle, 
  description, 
  theme = 'blue', 
  align = 'left',
  primaryLink,
  secondaryLink 
} = Astro.props;

// 2. DEFINE THEME MAP
const themeMap = {
  // NEW: Matches your Portfolio Page (Emerald/Cyan)
  market: {
    accent: 'text-emerald-400',
    glow: 'bg-emerald-500/10',
    button: 'bg-emerald-500 hover:bg-emerald-400 text-black shadow-emerald-500/20',
    border: 'border-emerald-500/30',
    subtle: 'text-emerald-100/60',
    line: 'bg-gradient-to-r from-emerald-500 to-cyan-500' // Gradient line!
  },
  red: {
    accent: 'text-red-500',
    glow: 'bg-red-500/5',
    button: 'bg-red-500 hover:bg-red-400 text-black shadow-red-500/20',
    border: 'border-red-500/30',
    subtle: 'text-red-100/60',
    line: 'bg-red-500'
  },
  blue: {
    accent: 'text-blue-400',
    glow: 'bg-blue-600/10',
    button: 'bg-white hover:bg-blue-50 text-blue-950 shadow-blue-500/20',
    border: 'border-blue-900/30',
    subtle: 'text-blue-100/60',
    line: 'bg-blue-400'
  },
  purple: {
    accent: 'text-purple-400',
    glow: 'bg-purple-600/10',
    button: 'bg-white hover:bg-purple-50 text-purple-950 shadow-purple-500/20',
    border: 'border-purple-900/30',
    subtle: 'text-purple-100/60',
    line: 'bg-purple-400'
  },
  emerald: {
    accent: 'text-emerald-400',
    glow: 'bg-emerald-500/5',
    button: 'bg-white hover:bg-emerald-50 text-emerald-950 shadow-emerald-500/20',
    border: 'border-emerald-900/30',
    subtle: 'text-emerald-100/60',
    line: 'bg-emerald-400'
  },
  cyan: {
    accent: 'text-cyan-400',
    glow: 'bg-cyan-500/5',
    button: 'bg-white hover:bg-cyan-50 text-cyan-950 shadow-cyan-500/20',
    border: 'border-cyan-900/30',
    subtle: 'text-cyan-100/60',
    line: 'bg-cyan-400'
  },
  amber: {
    accent: 'text-amber-500',
    glow: 'bg-amber-500/10',
    button: 'bg-amber-500 hover:bg-amber-400 text-black font-black shadow-[0_0_20px_rgba(245,158,11,0.3)]', 
    border: 'border-amber-500/50',
    subtle: 'text-amber-200/50', 
    line: 'bg-amber-500'
  },
};

// 3. GET COLORS (Safe access with fallback)
// We cast theme as any to avoid TS index errors if you pass a string not in the specific map key types, 
// though the interface above protects us mostly.
const colors = (themeMap as any)[theme] || themeMap['blue'];

const isRight = align === 'right';
---

<section class="py-32 relative overflow-hidden border-b border-neutral-900 bg-neutral-950">
  
  {/* Ambient Glow */}
  <div 
    class={`absolute w-[800px] h-[800px] rounded-full blur-[120px] pointer-events-none ${colors.glow}`}
    style={{ 
      top: isRight ? '50%' : '0', 
      left: isRight ? '0' : 'auto', 
      right: isRight ? 'auto' : '0',
      transform: 'translate(-20%, -20%)'
    }}
  ></div>

  <div class="max-w-7xl mx-auto px-6 md:px-12 relative z-10">
    <div class={`grid grid-cols-1 lg:grid-cols-2 gap-16 items-center ${isRight ? 'lg:grid-flow-dense' : ''}`}>
      
      {/* TEXT COLUMN */}
      <div class={`${isRight ? 'lg:col-start-2' : ''}`}>
        <h2 class={`${colors.accent} font-bold tracking-widest uppercase mb-6 text-sm flex items-center gap-3`}>
            <span class={`w-12 h-1 rounded-full ${colors.line}`}></span> {subtitle}
        </h2>
        
        <h3 class="text-5xl md:text-7xl font-black text-white mb-8 leading-[0.9] drop-shadow-lg font-title uppercase tracking-tighter">
           <Fragment set:html={title} />
        </h3>
        
        <p class="text-neutral-400 text-lg md:text-xl mb-10 leading-relaxed max-w-xl">
          {description}
        </p>
        
        <div class="flex flex-wrap gap-4">
            {primaryLink && (
              <a 
                href={primaryLink.href} 
                class={`inline-flex items-center gap-3 px-8 py-4 font-black font-title text-xl uppercase tracking-wider rounded-xl transition-all hover:scale-105 active:scale-95 shadow-lg ${colors.button}`}
              >
                {primaryLink.text} 
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path></svg>
              </a>
            )}
            {secondaryLink && (
               <a 
                 href={secondaryLink.href} 
                 class={`inline-flex items-center gap-2 px-8 py-4 border bg-transparent font-bold font-title text-xl uppercase tracking-wider rounded-xl transition-colors ${colors.border} hover:bg-white/5 text-white`}
               >
                  {secondaryLink.text}
               </a>
            )}
         </div>
      </div>

      {/* VISUAL COLUMN (Slot for Image/Widget) */}
      <div class={`relative ${isRight ? 'lg:col-start-1' : ''}`}>
         <slot />
      </div>

    </div>
  </div>
</section>